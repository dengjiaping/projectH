<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>

    <title>活动</title>
    <meta name="keywords" content="后会有期"/>
    <meta name="description" content="后会有期"/>

    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

    <script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script><!--微信JSsdk-->
    <!--魔窗-->
    <script src="https://static.mlinks.cc/scripts/dist/mlink.min.js"></script>

    <!-- 接口前缀-->
    <script src="js/key.js"></script>
    <script src="js/common.js"></script>

    <link rel="stylesheet" href="css/swiper.min.css"/>
    <link rel="stylesheet" href="css/zp.css"/>
    <link rel="stylesheet" href="css/common.css"/>
    <link rel="stylesheet" href="css/css.css"/>
</head>
<body>

<!--card轮播-->
<div class="swiper-container swiper1">
    <div class="swiper-wrapper">
        <div class="swiper-slide">
            <div class="card_container" style="background: transparent!important;">
            </div>
        </div>


        <!-- card1  -------->
        <div class="swiper-slide">
            <div class="card_container card_container1">
                <div class="card1_title">
                    <img src="images/applogo.png" alt=""/>
                    <h1>后会有期</h1>
                </div>
                <img src="images/activity_title.png" class="activity_title" alt=""/>
                <img src="images/ewm.png" class="appewm" alt=""/>
                <a href="" class="activity_upload" id="activity_upload">下载APP</a>
            </div>
        </div>
        <!-- card1  -->


        <!-- card2 ----转盘抽奖---->
        <div class="swiper-slide">
            <div class="card_container card_container2">
                <img src="images/zp_title.png" alt=""/>
                <div class="zp_top">
                    <h1><!--奖池剩余金额：0.00元--></h1>
                    <h2><!--参与人数：85人--></h2>
                    <div class="clear"></div>
                </div>
                <div id="zp" class="zp">
                    <div class="outer KinerLottery KinerLotteryContent"><img src="images/zzsc.png"></div>
                    <div class="inner KinerLotteryBtn start"></div>
                    <!--<div id="is_login"></div>-->
                </div>
                <button class="acivity_xiangqing">活动详情</button>
                <div class="zp_bom">
                    <div class="shengyu_cishu">
                        剩余抽奖次数<span>0</span>次
                    </div>
                    <input type="button" class="jilu_btn" value="我的中奖记录"/>
                    <input type="button" class="zhuli_btn" value="邀请好友助力"/>
                </div>
            </div>
        </div>
        <!-- card2 --------转盘抽奖-->


        <!-- card3----人气女神---->
        <div class="swiper-slide">
            <div class="card_container card_container3">
                <input type="button" value="人气女神排行榜" id="nvshen_ph" style="width: 150px;height: 35px;border: none;background: #6695b9;color: #fff; font-size: 14px;display: block;margin: 100px auto;"/>
            </div>
        </div>
        <!-- card3----人气女神---->


        <!-- card4 -->
        <div class="swiper-slide">
            <div class="card_container" style="background: blue">

            </div>
        </div>
        <!-- card4 -->


        <!-- card5 -->
        <div class="swiper-slide">
            <div class="card_container" style="background: yellow;"></div>
        </div>
        <!-- card5 -->


        <div class="swiper-slide">
            <div class="a1" style="background: transparent!important;"></div>
        </div>
    </div>
</div>
<!------------card轮播------------->

<!---为TA助力---->
<section>
    <div class="help_modal">
        <div class="all_black_bg7">
            <div class="distable">
                <div class="distabcell">
                    <div class="help">
                        <div class="help_user">
                            <h1>为TA助力</h1>
                            <img src="images/tx.jpg" alt=""/>
                            <h2>韩梅梅</h2>
                            <h3>我正在申请【后会有期】APP游戏大礼包，需要你的一臂之力</h3>
                        </div>
                        <div class="zhuli_num">
                            <h2>已有<font color="#00b8e8">9</font>位玩家给TA助力</h2>
                        </div>
                        <div class="zhuli_user">
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>凌琳</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>香菱</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>阿芳</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>赵月</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>朱立宇</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>汪蕾</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>李璐</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>张芳</h6>
                            </div>
                            <div class="one_zhuli_user">
                                <img src="images/tx.jpg" alt=""/>
                                <h6>李雷</h6>
                            </div>
                            <div class="clear"></div>
                        </div>
                        <input type="button" value="助TA" class="btn_help"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!---为TA助力---->

<!---规则---->
<section>
    <div class="acivity_guize acivity_guize_modal">
        <h3>本活动最终解释权归后会有期所有</h3>
    </div>
</section>
<!---规则---->

<!---邀请助力---->
<section>
        <div class="all_black_bg7 zhuli_yaoqing_modal">
            <div class="zhuli_yaoqing">
                <img src="images/zhuliyaoqing.png" alt=""/>
            </div>
        </div>
</section>
<!---邀请助力---->

<!---中奖记录-->
<section>
    <div class="all_black_bg7 zhongjiangjilu_modal">
        <div class="distable">
            <div class="distabcell">
                <div class="zhongjiangjilu">
                    <img src="images/zhongjiangjilu_title.png" alt=""/>
                    <!--<h1>暂无记录</h1>-->
                    <div class="zhongjiangjilu_list">

                        <!--<div class="zj_jilu">-->
                            <!--<div class="zhongjiang_time">2017-07-20 14:24</div>-->
                            <!--<div class="zhongjiang_jine">中奖100元</div>-->
                            <!--<div class="clear"></div>-->
                        <!--</div>-->

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!---中奖记录 -->

<!---中奖奖品--modal---->
<section>
    <div class="all_black_bg7 zhongjiang_modal">
        <div class="distable zhongjiangla_bg">
            <div class="distabcell">
                <div class="zhongjiang">
                    <img src="images/zhongjiangtitleimg.png" alt=""/>
                    <div class="jiangxiang">
                        <h1>恭喜获得</h1>
                        <h2><!--5元现金奖励，请至后会有期APP进行体现，邀请10位好友助力可再获得一次抽奖机会--></h2>
                    </div>
                    <input type="button" value="邀请好友" class="yaoqing_haoyou"/>
                </div>
            </div>
        </div>
    </div>
</section>
<!---中奖奖品--modal---->

<!---不能抽奖---->
<section>
    <div class="tishi">
        <div class="distable">
            <div class="distabcell">
                <div class="tishi_val">
                    <!--对不起 &#45;&#45; 您的抽奖次数已用完-->
                </div>
            </div>
        </div>
    </div>
</section>
<!---不能抽奖---->

</body>


<!--Swiper切换----获取高度-->
<script src="js/swiper.min.js"></script>
<script>
    var mySwiper1 = new Swiper('.swiper1',{
        spaceBetween: 0,
        slidesPerView : 3,
        paginationClickable: true,
        autopalyDisableOnInteraction:false
    });
    $(document).ready(function () {
        //card高度+++++
        $(".swiper1").height($(window).height()-50);
        $(".swiper1 .swiper-slide").height($(window).height()-50);
        //card高度-----

        //人气女神榜排行高度+++++
        var container_height = $(".card_container3").height();
        var titleimg_height = $(".nvshen_paihang_titleimg").height();
        var nvshen_paihang_container_height = container_height-titleimg_height-10-25-50;
        $(".nvshen_paihang_container").height(nvshen_paihang_container_height);
        //人气女神榜排行高度-----
    })
</script>
<!--Swiper切换---获取高度-->


<!--页面刚加载时的数据-->
<script>

    var usertoken;
    var userid;
    var code;

    $(function () {
        code = getQueryString("code");
        load();
        login();
    });

    function login(){

        if(code){
            alert(code);
            var params = {"code":code};
            $.ajax({
                type:'post',
                dataType:'json',
                url:ContextPath+'view/login',
                data: params,
                success:function(json){
                    if(!json.success){
                        alert("获取token失败--:"+json.msg);
                        getcode();
                        return;
                    }
                    //获取token之后存到本地缓存
                    var datas = json.data;
                    alert("ajax获取----userid:"+datas.id+"---usertoken:"+datas.token);

                    localStorage.setItem("userid",datas.id);
                    localStorage.setItem("usertoken",datas.token);

                    location.href = 'https://hzease.com/activity/index.html';
                },
                error: function (e) {
                    alert("获取token--"+e.status + ',' + e.statusText);
                }
            });
        }
    }

    function load() {
        $.ajax({
            type:'post',
            dataType:'json',
            url:ContextPath+'/view/allPrizeInfo',
            success:function(json){
                console.dir(json.data);
                var datas = json.data;
                $(".zp_top h1").empty().append('奖池剩余金额：'+datas.allMoney+'元');
                $(".zp_top h2").empty().append('参与人数：'+datas.joinMember+'人');
            }
        });
    }



    function getcode() {
//        var url_code = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1455b640ec310a00&redirect_uri=' + location.href + '&response_type=code&scope=snsapi_login&state=1#wechat_redirect';
        var url_code = 'https://open.weixin.qq.com/connect/qrconnect?appid=wx1455b640ec310a00&redirect_uri='+location.href+'&response_type=code&scope=snsapi_login&state=1#wechat_redirect';
        location.href = url_code;
    }


    function clear_localStorage() {
        var $nvshen_paihang_container = $(".nvshen_paihang_container").html('');
        $.ajax({
            type:'post',
            dataType: 'json',
            url:'http://www.com',
            data:'',
            success: function () {

            }
        });


        $.ajax({
            type:'post',
            dataType:'json',
            url:ContextPath+'/view/findPrizeList',
            data: {"token":localStorage.getItem("usertoken"),"userId":localStorage.getItem("userid")},
            success:function(json){
                if(!json.success){
                    alert(json.msg);
                    return;
                }
                var data = json.data;
                console.dir(data);
                var $zhongjiangjilu_list = $(".zhongjiangjilu_list").html('');

                $.each(data,function (index,obj) {
                    var $zhongjiang_time = $('<div class="zhongjiang_time">'+obj.drawTime+'</div>');
                    var $zhongjiang_jine = $('<div class="zhongjiang_jine">中奖'+obj.money/100+'元</div>');
                    var $clear = $('<div class="clear"></div>');
                    var $zj_jilu = $('<div class="zj_jilu"></div>');
                    $zj_jilu.append($zhongjiang_time);
                    $zj_jilu.append($zhongjiang_jine);
                    $zj_jilu.append($clear);
                    $zhongjiangjilu_list.append($zj_jilu);
                })

            }
        });
    }

</script>
<!--页面刚加载时的数据-->


<!--模态框------modal-->
<script>
    $(document).ready(function () {

        //-----ALL-modal---模态框
        $(".acivity_xiangqing").on('click', function () {
            $(".acivity_guize_modal").fadeIn(500);
        });
        $(".acivity_guize_modal").on('click', function () {
            $(".acivity_guize_modal").fadeOut(500);
        });
        $(".zhuli_btn").on('click', function () {
            $(".zhuli_yaoqing_modal").fadeIn(500);
        });
        $(".zhuli_yaoqing_modal").on('click', function () {
            $(".zhuli_yaoqing_modal").fadeOut(500);
        });

        //--查看中奖记录
        $(".jilu_btn").on('click', function () {
            var isLogin = (localStorage.getItem("usertoken") && localStorage.getItem("userid"));
            if (!isLogin) {
                alert('请先登陆');
                getcode();
                return;
            }
            $.ajax({
                type: 'post',
                dataType: 'json',
                url: ContextPath + '/view/findPrizeList',
                data: {"token": localStorage.getItem("usertoken"), "userId": localStorage.getItem("userid")},
                success: function (json) {
                    if (!json.success) {
                        alert(json.msg);
                        return;
                    }
                    var data = json.data;
                    console.dir(data);
                    var $zhongjiangjilu_list = $(".zhongjiangjilu_list").html('');

                    $.each(data, function (index, obj) {
                        var $zhongjiang_time = $('<div class="zhongjiang_time">' + obj.drawTime + '</div>');
                        var $zhongjiang_jine = $('<div class="zhongjiang_jine">中奖' + obj.money / 100 + '元</div>');
                        var $clear = $('<div class="clear"></div>');
                        var $zj_jilu = $('<div class="zj_jilu"></div>');
                        $zj_jilu.append($zhongjiang_time);
                        $zj_jilu.append($zhongjiang_jine);
                        $zj_jilu.append($clear);
                        $zhongjiangjilu_list.append($zj_jilu);
                    })

                }
            });
            $(".zhongjiangjilu_modal").fadeIn(500);


        });
        $(".zhongjiangjilu_modal").on('click', function () {
            $(".zhongjiangjilu_modal").fadeOut(500);
        });
        //--查看中奖记录


        $(".yaoqing_haoyou").on('click', function () {
            $(".zhongjiang_modal").fadeOut(500);
            $(".zhuli_yaoqing_modal").fadeIn(500);
        });
        $(".zhongjiang_modal").on('click', function () {
            $(".zhongjiang_modal").fadeOut(500);
        });
        //-----ALL-modal---模态框


    })

</script>
<!--模态框------modal-->


<!-----转盘------>
<script src="js/zepto.min.js"></script>
<script src="js/zp.js"></script>
<script>
    function tishi_out() {
        setTimeout(function () {
            $(".tishi").fadeOut(500);
        },2000)
    }//提示框2秒后消失

    //------旋转角度
    var whichAward = function(deg) {
        if ((deg > 337 && deg <= 360) || (deg > 0 && deg <= 22)) { //10M流量
            return "iphone7 plus 128G黑色";
        } else if ((deg > 22 && deg <= 67)) { //50元
            return "50元";
        } else if (deg > 67 && deg <= 112) { //10元
            return "10元";
        } else if (deg > 112 && deg <= 157) { //100元
            return "100元";
        } else if (deg > 157 && deg <= 202) { //1元
            return "1元";
        } else if (deg > 202 && deg <= 247) { //3元
            return "3元";
        }else if (deg > 247 && deg <= 292) { //8888元
            return "8888元";
        }else if (deg > 292 && deg <= 337) { //5元
            return "5元";
        }
    };

    var whichJiaodu = function(jiangpin) {
        if(jiangpin == 5000){ //50元
            return 45;
        }
        if(jiangpin == 1000){ //10元
            return 90;
        }
        if(jiangpin == 10000){//100元
            return 135;
        }
        if(jiangpin == 100){//1元
            return 180;
        }
        if(jiangpin == 300){ //3元
            return 225;
        }
        if(jiangpin == 888800){//8888元
            return 270;
        }
        if(jiangpin == 500){//5元
            return 315;
        }
    };

    //------转盘
    var KinerLottery = new KinerLottery({
        rotateNum: 8, //转盘转动圈数
        body: "#zp", //大转盘整体的选择符或zepto对象
        direction: 1, //0为顺时针转动,1为逆时针转动


        clickCallback: function() {
            //此处访问接口获取奖品
            var data = window.DrawObject;
            var jiaodu =whichJiaodu(data.money);
            this.goKinerLottery(jiaodu);


        }, //点击抽奖按钮,再次回调中实现访问后台获取抽奖结果,拿到抽奖结果后显示抽奖画面

        KinerLotteryHandler: function(deg) {
            $(".zhongjiang_modal").fadeIn(500);//弹出奖品
            $(".jiangxiang h2").empty().html(whichAward(deg)+'奖励，请至后会有期APP进行体现，邀请10位好友助力可再获得一次抽奖机会');
        } //抽奖结束回调
    });
</script>
<!-----转盘------>


<!--页面跳转-->
<script>
    $(document).ready(function () {
        $("#nvshen_ph").on('click', function () {
            window.location.href = 'https://hzease.com/activity/nvshen.html';
        })
    })
</script>
<!--页面跳转-->


<!--魔窗-->
<script>
    new Mlink({
        mlink: 'AcpY',//短链地址
        button: document.querySelector('a#activity_upload'),
        autoLaunchApp: false,
        autoRedirectToDownloadUrl: true,
        downloadWhenUniversalLinkFailed: false
    });
</script>
<!--魔窗-->


</html>